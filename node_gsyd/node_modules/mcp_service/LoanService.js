var cons=require('mcp_constants');
var investStatus=cons.investStatus;

var dc=require('mcp_db').dc;


var LoanService = function(){};


LoanService.prototype.getRemainMoney = function(id,cb){
    var sql="select ifnull(sum(money),0) as remainMoney from invest where loan_id='"+id+"' and status !='"+investStatus.cancel+"'";
    var conn=dc.main.getConn();
    console.log("sql: "+sql);
    conn.execute(sql, {}, function (err, data) {
        if(err){
            cb(err);
        }else{
            cb(null, data.remainMoney);
        }
    });
};


module.exports = new LoanService();