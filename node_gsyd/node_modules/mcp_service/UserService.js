/**
 * Created by shiqm on 16-3-24.
 */
'use strict';

var dc = require('mcp_db').dc;

var esul = require('easy_util');
var digestUtil = esul.digestUtil;

var util = require('mcp_util');
var objectUtil = util.objectUtil;

var async = require('async');

var UserService = function () {
};

UserService.prototype.getUserList = function (cb) {
    var conn = dc.main.getConn();
    var sql = "SELECT a.id,a.username,a.realname,a.sex,a.mobile_number,b.username referrerUsername,b.realname referrerRealname, b.mobile_number referrerMobileNumber,b.id_card,a.register_time,case (select COUNT(*) from invest where user_id=a.id and status='complete') when '0' then '未投资' else '已投资' end  as invset_status from user a left join user b  on a.referrer=b.id ";
    conn.execute(sql, [], function (err, data) {
           cb(err, data);
    })
};


module.exports = new UserService();